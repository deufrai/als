---
title: "Concepts"
description: "The basic concepts of ALS"
author: "ALS Team"

lastmod: 2024-12-31T05:32:00Z
keywords: [ "ALS concepts" ]
draft: false
type: "docs"
categories: [ "user guide" ]
tags: [ "basics", "module", "preprocess", "stack", "processing", "session", "scanned folder", "work folder", "web folder" ]
weight: 315
---

# Introduction

By the end of this chapter, you will know how ALS handles detected subs and what a session really is.

# Modules

ALS is architected in autonomous modules, divided into two families:

- **Main modules**: responsible for image processing tasks
    - **Preprocess**: Calibration
    - **Stack**: Alignment and stacking
    - **Process**: Visual processing
    - **Save**: Disk saving

- **Utility modules**: responsible for auxiliary tasks
    - **Scanner**: monitoring the **scanned folder**
    - **Server**: sharing images generated by ALS

## Image Path

Each detected sub passes from module to module in the following order:

```mermaid
graph LR
subgraph Main Modules
    B(Preprocess) --> C(Stack)
    C --> D(Process)
    D --> E(Save)
end
A(Scanner) --> B
E -.-> F(Server)

style A fill:#555,stroke:darkred,stroke-width:2px
style B fill:#333,stroke:darkred,stroke-width:2px,color:#c6c6c6,font-family:'Poppins',sans-serif
style C fill:#333,stroke:darkred,stroke-width:2px,color:#c6c6c6,font-family:'Poppins',sans-serif
style D fill:#333,stroke:darkred,stroke-width:2px,color:#c6c6c6,font-family:'Poppins',sans-serif
style E fill:#333,stroke:darkred,stroke-width:2px,color:#c6c6c6,font-family:'Poppins',sans-serif
style F fill:#555,stroke:darkred,stroke-width:2px
```

<p class="figcaption">Image path in ALS</p>

## Main Modules

These modules group and order the processes to be applied to subs as they move through the processing pipeline.

Each module has its own queue and continuously performs the following actions:

1. Waits for a new image to appear in the queue
2. Processes the image
3. Transmits the processing result to the next module

In case of an error during image processing:

1. The image processing is aborted and the image is not transmitted to the next module.
2. The skipping of the image is discreetly signaled in the application.
3. The module resumes listening to its queue

### Preprocess {#preprocess-module}

{{% alert color="info" %}}
ℹ️ As soon as a new sub is detected, it is added to this module's queue.
{{% /alert %}}

The **preprocess** module groups the following **calibration** processes:

1. **Hot pixel removal**

   Replaces the value of hot pixels with the average value of neighboring pixels.

2. **Master dark subtraction**

   Uses a master dark provided by the user to subtract thermal noise from the image.

3. **Debayering**

   **Color** images in **FITS** or **Raw** format are converted to RGB color using the Bayer matrix described in the
   file headers.

You can find more information about the **Preprocess** module in its [detailed documentation](../../modules/preprocess/).

### Stack {#stack-module}

The **Stack** module maintains the **current stack** and handles the following processes:

1. **Alignment**: Aligns the image to the session reference
2. **Stacking**
    - Adds the image to the current stack
    - Generates the stacking result based on the mode chosen by the user (_mean or sum_) and sends it to the **Process**
      module

{{% alert color="info" %}}
ℹ️ Alignment is based on the search for star groups in the compared images. ALS can only align deep sky images. **Planet
or Moon images cannot be aligned**.
{{% /alert %}}

You can find more information about the **Stack** module in its [detailed documentation](../../modules/stack/).

### Process {#process-module}

The **Process** module groups the visual processing applied to the stacking result:

1. **Auto stretch**

   Automatically adjusts the image levels for optimal viewing

2. **Levels**

   Allows adjusting the black and white clipping, and the mid-tone level

3. **RGB balance**

   Allows adjusting the color balance

{{% alert color="info" %}}
ℹ️ The image displayed in ALS's **central area** is replaced by each image output from the **Process** module
{{% /alert %}}

### Save {#save-module}

The **Save** module is in charge of saving to disk every image processing result received from the **Process** module.

The **Save** module saves images in two target folders:
- The **work folder** for processing results
- The **web folder** for images shared over the network, served by the **Server** module

Each processing result is saved in 2 files:

1. Main output:
    - **Location**: work folder
    - **Name**: stack_image
    - **Format**: As defined in [Preferences](../preferences/output/#format). ℹ️ Default: JPEG

2. Server output:
    - **Location**: web folder
    - **Name**: web_image
    - **Format**: JPEG

{{% alert color="warning" %}}
⚠️ These 2 files are overwritten by every successive processing result.
{{% /alert %}}

{{% alert color="info" %}}
ℹ️ By default, the path of the **web folder** is the same as that of the **work folder**.

You can define a specific **web folder** in the [Preferences](../preferences/output/#web-folder).
{{% /alert %}}

You can find more information about the **Save** module in its [detailed documentation](../../modules/save/).

## Utility Modules

ALS uses other modules that are not involved in image processing. However, they are essential for the proper functioning
of the application:

### Scanner

This module is responsible for detecting new subs in the **scan folder** and transmitting them to the
**Preprocess** module.

You can find more information about the **Scanner** module in its [detailed documentation](../../modules/scanner/).

### Server

This module handles sharing the **server output** of the **Save** module over the network.

It is accessible from the network to which the machine running ALS is connected.

The image displayed on the served web page is periodically refreshed by browsers.

{{% alert color="info" %}}
ℹ️ When the server is started, its address is displayed in the application and a QR code can be displayed on demand.
{{% /alert %}}

---

# The Session {#session}

Within ALS, the session occupies a prominent place.

**The session** can be seen as the materialization of the lifecycle of the pair formed by the **current stack** and the
**scanner**.

1. **Start**:
    - ALS starts the **scanner** and clears the **current stack**.
    - **First Detection**: The first sub received by the **Stack** module will serve as **alignment reference**
      throughout the session.

2. **Running**:
    - each new detected sub is in turn:
        - calibrated
        - aligned to the reference image
        - added to current stack
    - The successive results of this stacking are processed then displayed by the application and saved to disk.

   The session can be paused: ALS stops the **scanner** and the **current stack** is **preserved**.
   Restarting the session simply restarts the **scanner**.

   At any time, the user can navigate the displayed image, zoom, adjust processing parameters...

3. **Stop**:
    - When the session stops, the **scanner** is stopped and the **current stack** is marked to be cleared at the
      next session start.

{{% alert color="info" %}}
ℹ️ ALS does not process images already present in the **scanned folder** when a session starts
{{% /alert %}}

# Conclusion

You now have a clear understanding of the architecture and basic concepts of ALS.

Next step: the ALS graphical interface.
